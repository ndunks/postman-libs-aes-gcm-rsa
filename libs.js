if(!this["navigator"]){this["navigator"]={}}function wordToByteArray(word,length){var ba=[],i,xFF=255;if(length>0)ba.push(word>>>24);if(length>1)ba.push(word>>>16&xFF);if(length>2)ba.push(word>>>8&xFF);if(length>3)ba.push(word&xFF);return ba}function wordArrayToByteArray(p){length=p.sigBytes;wordArray=p.words;var result=[],bytes,i=0;while(length>0){bytes=wordToByteArray(wordArray[i],Math.min(4,length));length-=bytes.length;result.push(bytes);i++}return[].concat.apply([],result)}function parseBigInt(str,r){return new BigInteger(str,r)}function linebrk(s,n){var ret="";var i=0;while(i+n<s.length){ret+=s.substring(i,i+n)+"\n";i+=n}return ret+s.substring(i,s.length)}function byte2Hex(b){if(b<16)return"0"+b.toString(16);else return b.toString(16)}function pkcs1pad2(s,n){if(n<s.length+11){throw"Message too long for RSA";return null}var ba=new Array;var i=s.length-1;while(i>=0&&n>0){ba[--n]=s[i--]}ba[--n]=0;var rng=new SecureRandom;var x=new Array;while(n>2){x[0]=0;while(x[0]==0)rng.nextBytes(x);ba[--n]=x[0]}ba[--n]=2;ba[--n]=0;return new BigInteger(ba)}function oaep_mgf1_arr(seed,len,hash){var mask="",i=0;while(mask.length<len){mask+=hash(String.fromCharCode.apply(String,seed.concat([(i&4278190080)>>24,(i&16711680)>>16,(i&65280)>>8,i&255])));i+=1}return mask}function oaep_pad(s,n,hash,hashLen){var MD=KJUR.crypto.MessageDigest;var Util=KJUR.crypto.Util;var algName=null;if(!hash)hash="sha1";if(typeof hash==="string"){algName=MD.getCanonicalAlgName(hash);hashLen=MD.getHashLength(algName);hash=function(s){return hextorstr(Util.hashHex(rstrtohex(s),algName))}}if(s.length+2*hashLen+2>n){throw"Message too long for RSA"}var PS="",i;for(i=0;i<n-s.length-2*hashLen-2;i+=1){PS+="\0"}var DB=hash("")+PS+""+s;var seed=new Array(hashLen);(new SecureRandom).nextBytes(seed);var dbMask=oaep_mgf1_arr(seed,DB.length,hash);var maskedDB=[];for(i=0;i<DB.length;i+=1){maskedDB[i]=DB.charCodeAt(i)^dbMask.charCodeAt(i)}var seedMask=oaep_mgf1_arr(maskedDB,seed.length,hash);var maskedSeed=[0];for(i=0;i<seed.length;i+=1){maskedSeed[i+1]=seed[i]^seedMask.charCodeAt(i)}return new BigInteger(maskedSeed.concat(maskedDB))}function RSAKey(){this.n=null;this.e=0;this.d=null;this.p=null;this.q=null;this.dmp1=null;this.dmq1=null;this.coeff=null}function RSASetPublic(N,E){this.isPublic=true;this.isPrivate=false;if(typeof N!=="string"){this.n=N;this.e=E}else if(N!=null&&E!=null&&N.length>0&&E.length>0){this.n=parseBigInt(N,16);this.e=parseInt(E,16)}else{throw"Invalid RSA public key"}}function RSADoPublic(x){return x.modPowInt(this.e,this.n)}function RSAEncrypt(text){var m=pkcs1pad2(text,this.n.bitLength()+7>>3);if(m==null)return null;var c=this.doPublic(m);if(c==null)return null;var h=c.toString(16);if((h.length&1)==0)return h;else return"0"+h}function RSAEncryptOAEP(text,hash,hashLen){var n=this.n.bitLength()+7>>3;var m=oaep_pad(text,n,hash,hashLen);if(m==null)return null;var c=this.doPublic(m);if(c==null)return null;var h=c.toString(16);while(h.length<n*2)h="0"+h;return h}RSAKey.prototype.doPublic=RSADoPublic;RSAKey.prototype.setPublic=RSASetPublic;RSAKey.prototype.encrypt=RSAEncrypt;RSAKey.prototype.encryptOAEP=RSAEncryptOAEP;RSAKey.prototype.type="RSA";function Arcfour(){this.i=0;this.j=0;this.S=new Array}function ARC4init(key){var i,j,t;for(i=0;i<256;++i)this.S[i]=i;j=0;for(i=0;i<256;++i){j=j+this.S[i]+key[i%key.length]&255;t=this.S[i];this.S[i]=this.S[j];this.S[j]=t}this.i=0;this.j=0}function ARC4next(){var t;this.i=this.i+1&255;this.j=this.j+this.S[this.i]&255;t=this.S[this.i];this.S[this.i]=this.S[this.j];this.S[this.j]=t;return this.S[t+this.S[this.i]&255]}Arcfour.prototype.init=ARC4init;Arcfour.prototype.next=ARC4next;function prng_newstate(){return new Arcfour}var rng_psize=256;var rng_state;var rng_pool;var rng_pptr;function rng_seed_int(x){rng_pool[rng_pptr++]^=x&255;rng_pool[rng_pptr++]^=x>>8&255;rng_pool[rng_pptr++]^=x>>16&255;rng_pool[rng_pptr++]^=x>>24&255;if(rng_pptr>=rng_psize)rng_pptr-=rng_psize}function rng_seed_time(){rng_seed_int((new Date).getTime())}if(rng_pool==null){rng_pool=new Array;rng_pptr=0;var t;if(typeof window!=="undefined"&&(window.crypto!==undefined||window.msCrypto!==undefined)){var crypto=window.crypto||window.msCrypto;if(crypto.getRandomValues){var ua=new Uint8Array(32);crypto.getRandomValues(ua);for(t=0;t<32;++t)rng_pool[rng_pptr++]=ua[t]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var z=window.crypto.random(32);for(t=0;t<z.length;++t)rng_pool[rng_pptr++]=z.charCodeAt(t)&255}}while(rng_pptr<rng_psize){t=Math.floor(65536*Math.random());rng_pool[rng_pptr++]=t>>>8;rng_pool[rng_pptr++]=t&255}rng_pptr=0;rng_seed_time()}function rng_get_byte(){if(rng_state==null){rng_seed_time();rng_state=prng_newstate();rng_state.init(rng_pool);for(rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}function rng_get_bytes(ba){var i;for(i=0;i<ba.length;++i)ba[i]=rng_get_byte()}function SecureRandom(){}SecureRandom.prototype.nextBytes=rng_get_bytes;var dbits;var canary=0xdeadbeefcafe;var j_lm=(canary&16777215)==15715070;function BigInteger(a,b,c){if(a!=null)if("number"==typeof a)this.fromNumber(a,b,c);else if(b==null&&"string"!=typeof a)this.fromString(a,256);else this.fromString(a,b)}function nbi(){return new BigInteger(null)}function am1(i,x,w,j,c,n){while(--n>=0){var v=x*this[i++]+w[j]+c;c=Math.floor(v/67108864);w[j++]=v&67108863}return c}function am2(i,x,w,j,c,n){var xl=x&32767,xh=x>>15;while(--n>=0){var l=this[i]&32767;var h=this[i++]>>15;var m=xh*l+h*xl;l=xl*l+((m&32767)<<15)+w[j]+(c&1073741823);c=(l>>>30)+(m>>>15)+xh*h+(c>>>30);w[j++]=l&1073741823}return c}function am3(i,x,w,j,c,n){var xl=x&16383,xh=x>>14;while(--n>=0){var l=this[i]&16383;var h=this[i++]>>14;var m=xh*l+h*xl;l=xl*l+((m&16383)<<14)+w[j]+c;c=(l>>28)+(m>>14)+xh*h;w[j++]=l&268435455}return c}if(j_lm&&navigator.appName=="Microsoft Internet Explorer"){BigInteger.prototype.am=am2;dbits=30}else if(j_lm&&navigator.appName!="Netscape"){BigInteger.prototype.am=am1;dbits=26}else{BigInteger.prototype.am=am3;dbits=28}BigInteger.prototype.DB=dbits;BigInteger.prototype.DM=(1<<dbits)-1;BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP);BigInteger.prototype.F1=BI_FP-dbits;BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";var BI_RC=new Array;var rr,vv;rr="0".charCodeAt(0);for(vv=0;vv<=9;++vv)BI_RC[rr++]=vv;rr="a".charCodeAt(0);for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;rr="A".charCodeAt(0);for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(n){return BI_RM.charAt(n)}function intAt(s,i){var c=BI_RC[s.charCodeAt(i)];return c==null?-1:c}function bnpCopyTo(r){for(var i=this.t-1;i>=0;--i)r[i]=this[i];r.t=this.t;r.s=this.s}function bnpFromInt(x){this.t=1;this.s=x<0?-1:0;if(x>0)this[0]=x;else if(x<-1)this[0]=x+this.DV;else this.t=0}function nbv(i){var r=nbi();r.fromInt(i);return r}function bnpFromString(s,b){var k;if(b==16)k=4;else if(b==8)k=3;else if(b==256)k=8;else if(b==2)k=1;else if(b==32)k=5;else if(b==4)k=2;else{this.fromRadix(s,b);return}this.t=0;this.s=0;var i=s.length,mi=false,sh=0;while(--i>=0){var x=k==8?s[i]&255:intAt(s,i);if(x<0){if(s.charAt(i)=="-")mi=true;continue}mi=false;if(sh==0)this[this.t++]=x;else if(sh+k>this.DB){this[this.t-1]|=(x&(1<<this.DB-sh)-1)<<sh;this[this.t++]=x>>this.DB-sh}else this[this.t-1]|=x<<sh;sh+=k;if(sh>=this.DB)sh-=this.DB}if(k==8&&(s[0]&128)!=0){this.s=-1;if(sh>0)this[this.t-1]|=(1<<this.DB-sh)-1<<sh}this.clamp();if(mi)BigInteger.ZERO.subTo(this,this)}function bnpClamp(){var c=this.s&this.DM;while(this.t>0&&this[this.t-1]==c)--this.t}function bnToString(b){if(this.s<0)return"-"+this.negate().toString(b);var k;if(b==16)k=4;else if(b==8)k=3;else if(b==2)k=1;else if(b==32)k=5;else if(b==4)k=2;else return this.toRadix(b);var km=(1<<k)-1,d,m=false,r="",i=this.t;var p=this.DB-i*this.DB%k;if(i-- >0){if(p<this.DB&&(d=this[i]>>p)>0){m=true;r=int2char(d)}while(i>=0){if(p<k){d=(this[i]&(1<<p)-1)<<k-p;d|=this[--i]>>(p+=this.DB-k)}else{d=this[i]>>(p-=k)&km;if(p<=0){p+=this.DB;--i}}if(d>0)m=true;if(m)r+=int2char(d)}}return m?r:"0"}function bnNegate(){var r=nbi();BigInteger.ZERO.subTo(this,r);return r}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(a){var r=this.s-a.s;if(r!=0)return r;var i=this.t;r=i-a.t;if(r!=0)return this.s<0?-r:r;while(--i>=0)if((r=this[i]-a[i])!=0)return r;return 0}function nbits(x){var r=1,t;if((t=x>>>16)!=0){x=t;r+=16}if((t=x>>8)!=0){x=t;r+=8}if((t=x>>4)!=0){x=t;r+=4}if((t=x>>2)!=0){x=t;r+=2}if((t=x>>1)!=0){x=t;r+=1}return r}function bnBitLength(){if(this.t<=0)return 0;return this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(n,r){var i;for(i=this.t-1;i>=0;--i)r[i+n]=this[i];for(i=n-1;i>=0;--i)r[i]=0;r.t=this.t+n;r.s=this.s}function bnpDRShiftTo(n,r){for(var i=n;i<this.t;++i)r[i-n]=this[i];r.t=Math.max(this.t-n,0);r.s=this.s}function bnpLShiftTo(n,r){var bs=n%this.DB;var cbs=this.DB-bs;var bm=(1<<cbs)-1;var ds=Math.floor(n/this.DB),c=this.s<<bs&this.DM,i;for(i=this.t-1;i>=0;--i){r[i+ds+1]=this[i]>>cbs|c;c=(this[i]&bm)<<bs}for(i=ds-1;i>=0;--i)r[i]=0;r[ds]=c;r.t=this.t+ds+1;r.s=this.s;r.clamp()}function bnpRShiftTo(n,r){r.s=this.s;var ds=Math.floor(n/this.DB);if(ds>=this.t){r.t=0;return}var bs=n%this.DB;var cbs=this.DB-bs;var bm=(1<<bs)-1;r[0]=this[ds]>>bs;for(var i=ds+1;i<this.t;++i){r[i-ds-1]|=(this[i]&bm)<<cbs;r[i-ds]=this[i]>>bs}if(bs>0)r[this.t-ds-1]|=(this.s&bm)<<cbs;r.t=this.t-ds;r.clamp()}function bnpSubTo(a,r){var i=0,c=0,m=Math.min(a.t,this.t);while(i<m){c+=this[i]-a[i];r[i++]=c&this.DM;c>>=this.DB}if(a.t<this.t){c-=a.s;while(i<this.t){c+=this[i];r[i++]=c&this.DM;c>>=this.DB}c+=this.s}else{c+=this.s;while(i<a.t){c-=a[i];r[i++]=c&this.DM;c>>=this.DB}c-=a.s}r.s=c<0?-1:0;if(c<-1)r[i++]=this.DV+c;else if(c>0)r[i++]=c;r.t=i;r.clamp()}function bnpMultiplyTo(a,r){var x=this.abs(),y=a.abs();var i=x.t;r.t=i+y.t;while(--i>=0)r[i]=0;for(i=0;i<y.t;++i)r[i+x.t]=x.am(0,y[i],r,i,0,x.t);r.s=0;r.clamp();if(this.s!=a.s)BigInteger.ZERO.subTo(r,r)}function bnpSquareTo(r){var x=this.abs();var i=r.t=2*x.t;while(--i>=0)r[i]=0;for(i=0;i<x.t-1;++i){var c=x.am(i,x[i],r,2*i,0,1);if((r[i+x.t]+=x.am(i+1,2*x[i],r,2*i+1,c,x.t-i-1))>=x.DV){r[i+x.t]-=x.DV;r[i+x.t+1]=1}}if(r.t>0)r[r.t-1]+=x.am(i,x[i],r,2*i,0,1);r.s=0;r.clamp()}function bnpDivRemTo(m,q,r){var pm=m.abs();if(pm.t<=0)return;var pt=this.abs();if(pt.t<pm.t){if(q!=null)q.fromInt(0);if(r!=null)this.copyTo(r);return}if(r==null)r=nbi();var y=nbi(),ts=this.s,ms=m.s;var nsh=this.DB-nbits(pm[pm.t-1]);if(nsh>0){pm.lShiftTo(nsh,y);pt.lShiftTo(nsh,r)}else{pm.copyTo(y);pt.copyTo(r)}var ys=y.t;var y0=y[ys-1];if(y0==0)return;var yt=y0*(1<<this.F1)+(ys>1?y[ys-2]>>this.F2:0);var d1=this.FV/yt,d2=(1<<this.F1)/yt,e=1<<this.F2;var i=r.t,j=i-ys,t=q==null?nbi():q;y.dlShiftTo(j,t);if(r.compareTo(t)>=0){r[r.t++]=1;r.subTo(t,r)}BigInteger.ONE.dlShiftTo(ys,t);t.subTo(y,y);while(y.t<ys)y[y.t++]=0;while(--j>=0){var qd=r[--i]==y0?this.DM:Math.floor(r[i]*d1+(r[i-1]+e)*d2);if((r[i]+=y.am(0,qd,r,j,0,ys))<qd){y.dlShiftTo(j,t);r.subTo(t,r);while(r[i]<--qd)r.subTo(t,r)}}if(q!=null){r.drShiftTo(ys,q);if(ts!=ms)BigInteger.ZERO.subTo(q,q)}r.t=ys;r.clamp();if(nsh>0)r.rShiftTo(nsh,r);if(ts<0)BigInteger.ZERO.subTo(r,r)}function bnMod(a){var r=nbi();this.abs().divRemTo(a,null,r);if(this.s<0&&r.compareTo(BigInteger.ZERO)>0)a.subTo(r,r);return r}function Classic(m){this.m=m}function cConvert(x){if(x.s<0||x.compareTo(this.m)>=0)return x.mod(this.m);else return x}function cRevert(x){return x}function cReduce(x){x.divRemTo(this.m,null,x)}function cMulTo(x,y,r){x.multiplyTo(y,r);this.reduce(r)}function cSqrTo(x,r){x.squareTo(r);this.reduce(r)}Classic.prototype.convert=cConvert;Classic.prototype.revert=cRevert;Classic.prototype.reduce=cReduce;Classic.prototype.mulTo=cMulTo;Classic.prototype.sqrTo=cSqrTo;function bnpInvDigit(){if(this.t<1)return 0;var x=this[0];if((x&1)==0)return 0;var y=x&3;y=y*(2-(x&15)*y)&15;y=y*(2-(x&255)*y)&255;y=y*(2-((x&65535)*y&65535))&65535;y=y*(2-x*y%this.DV)%this.DV;return y>0?this.DV-y:-y}function Montgomery(m){this.m=m;this.mp=m.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<m.DB-15)-1;this.mt2=2*m.t}function montConvert(x){var r=nbi();x.abs().dlShiftTo(this.m.t,r);r.divRemTo(this.m,null,r);if(x.s<0&&r.compareTo(BigInteger.ZERO)>0)this.m.subTo(r,r);return r}function montRevert(x){var r=nbi();x.copyTo(r);this.reduce(r);return r}function montReduce(x){while(x.t<=this.mt2)x[x.t++]=0;for(var i=0;i<this.m.t;++i){var j=x[i]&32767;var u0=j*this.mpl+((j*this.mph+(x[i]>>15)*this.mpl&this.um)<<15)&x.DM;j=i+this.m.t;x[j]+=this.m.am(0,u0,x,i,0,this.m.t);while(x[j]>=x.DV){x[j]-=x.DV;x[++j]++}}x.clamp();x.drShiftTo(this.m.t,x);if(x.compareTo(this.m)>=0)x.subTo(this.m,x)}function montSqrTo(x,r){x.squareTo(r);this.reduce(r)}function montMulTo(x,y,r){x.multiplyTo(y,r);this.reduce(r)}Montgomery.prototype.convert=montConvert;Montgomery.prototype.revert=montRevert;Montgomery.prototype.reduce=montReduce;Montgomery.prototype.mulTo=montMulTo;Montgomery.prototype.sqrTo=montSqrTo;function bnpIsEven(){return(this.t>0?this[0]&1:this.s)==0}function bnpExp(e,z){if(e>4294967295||e<1)return BigInteger.ONE;var r=nbi(),r2=nbi(),g=z.convert(this),i=nbits(e)-1;g.copyTo(r);while(--i>=0){z.sqrTo(r,r2);if((e&1<<i)>0)z.mulTo(r2,g,r);else{var t=r;r=r2;r2=t}}return z.revert(r)}function bnModPowInt(e,m){var z;if(e<256||m.isEven())z=new Classic(m);else z=new Montgomery(m);return this.exp(e,z)}BigInteger.prototype.copyTo=bnpCopyTo;BigInteger.prototype.fromInt=bnpFromInt;BigInteger.prototype.fromString=bnpFromString;BigInteger.prototype.clamp=bnpClamp;BigInteger.prototype.dlShiftTo=bnpDLShiftTo;BigInteger.prototype.drShiftTo=bnpDRShiftTo;BigInteger.prototype.lShiftTo=bnpLShiftTo;BigInteger.prototype.rShiftTo=bnpRShiftTo;BigInteger.prototype.subTo=bnpSubTo;BigInteger.prototype.multiplyTo=bnpMultiplyTo;BigInteger.prototype.squareTo=bnpSquareTo;BigInteger.prototype.divRemTo=bnpDivRemTo;BigInteger.prototype.invDigit=bnpInvDigit;BigInteger.prototype.isEven=bnpIsEven;BigInteger.prototype.exp=bnpExp;BigInteger.prototype.toString=bnToString;BigInteger.prototype.negate=bnNegate;BigInteger.prototype.abs=bnAbs;BigInteger.prototype.compareTo=bnCompareTo;BigInteger.prototype.bitLength=bnBitLength;BigInteger.prototype.mod=bnMod;BigInteger.prototype.modPowInt=bnModPowInt;BigInteger.ZERO=nbv(0);BigInteger.ONE=nbv(1);function bnClone(){var r=nbi();this.copyTo(r);return r}function bnIntValue(){if(this.s<0){if(this.t==1)return this[0]-this.DV;else if(this.t==0)return-1}else if(this.t==1)return this[0];else if(this.t==0)return 0;return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return this.t==0?this.s:this[0]<<24>>24}function bnShortValue(){return this.t==0?this.s:this[0]<<16>>16}function bnpChunkSize(r){return Math.floor(Math.LN2*this.DB/Math.log(r))}function bnSigNum(){if(this.s<0)return-1;else if(this.t<=0||this.t==1&&this[0]<=0)return 0;else return 1}function bnpToRadix(b){if(b==null)b=10;if(this.signum()==0||b<2||b>36)return"0";var cs=this.chunkSize(b);var a=Math.pow(b,cs);var d=nbv(a),y=nbi(),z=nbi(),r="";this.divRemTo(d,y,z);while(y.signum()>0){r=(a+z.intValue()).toString(b).substr(1)+r;y.divRemTo(d,y,z)}return z.intValue().toString(b)+r}function bnpFromRadix(s,b){this.fromInt(0);if(b==null)b=10;var cs=this.chunkSize(b);var d=Math.pow(b,cs),mi=false,j=0,w=0;for(var i=0;i<s.length;++i){var x=intAt(s,i);if(x<0){if(s.charAt(i)=="-"&&this.signum()==0)mi=true;continue}w=b*w+x;if(++j>=cs){this.dMultiply(d);this.dAddOffset(w,0);j=0;w=0}}if(j>0){this.dMultiply(Math.pow(b,j));this.dAddOffset(w,0)}if(mi)BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(a,b,c){if("number"==typeof b){if(a<2)this.fromInt(1);else{this.fromNumber(a,c);if(!this.testBit(a-1))this.bitwiseTo(BigInteger.ONE.shiftLeft(a-1),op_or,this);if(this.isEven())this.dAddOffset(1,0);while(!this.isProbablePrime(b)){this.dAddOffset(2,0);if(this.bitLength()>a)this.subTo(BigInteger.ONE.shiftLeft(a-1),this)}}}else{var x=new Array,t=a&7;x.length=(a>>3)+1;b.nextBytes(x);if(t>0)x[0]&=(1<<t)-1;else x[0]=0;this.fromString(x,256)}}function bnToByteArray(){var i=this.t,r=new Array;r[0]=this.s;var p=this.DB-i*this.DB%8,d,k=0;if(i-- >0){if(p<this.DB&&(d=this[i]>>p)!=(this.s&this.DM)>>p)r[k++]=d|this.s<<this.DB-p;while(i>=0){if(p<8){d=(this[i]&(1<<p)-1)<<8-p;d|=this[--i]>>(p+=this.DB-8)}else{d=this[i]>>(p-=8)&255;if(p<=0){p+=this.DB;--i}}if((d&128)!=0)d|=-256;if(k==0&&(this.s&128)!=(d&128))++k;if(k>0||d!=this.s)r[k++]=d}}return r}function bnEquals(a){return this.compareTo(a)==0}function bnMin(a){return this.compareTo(a)<0?this:a}function bnMax(a){return this.compareTo(a)>0?this:a}function bnpBitwiseTo(a,op,r){var i,f,m=Math.min(a.t,this.t);for(i=0;i<m;++i)r[i]=op(this[i],a[i]);if(a.t<this.t){f=a.s&this.DM;for(i=m;i<this.t;++i)r[i]=op(this[i],f);r.t=this.t}else{f=this.s&this.DM;for(i=m;i<a.t;++i)r[i]=op(f,a[i]);r.t=a.t}r.s=op(this.s,a.s);r.clamp()}function op_and(x,y){return x&y}function bnAnd(a){var r=nbi();this.bitwiseTo(a,op_and,r);return r}function op_or(x,y){return x|y}function bnOr(a){var r=nbi();this.bitwiseTo(a,op_or,r);return r}function op_xor(x,y){return x^y}function bnXor(a){var r=nbi();this.bitwiseTo(a,op_xor,r);return r}function op_andnot(x,y){return x&~y}function bnAndNot(a){var r=nbi();this.bitwiseTo(a,op_andnot,r);return r}function bnNot(){var r=nbi();for(var i=0;i<this.t;++i)r[i]=this.DM&~this[i];r.t=this.t;r.s=~this.s;return r}function bnShiftLeft(n){var r=nbi();if(n<0)this.rShiftTo(-n,r);else this.lShiftTo(n,r);return r}function bnShiftRight(n){var r=nbi();if(n<0)this.lShiftTo(-n,r);else this.rShiftTo(n,r);return r}function lbit(x){if(x==0)return-1;var r=0;if((x&65535)==0){x>>=16;r+=16}if((x&255)==0){x>>=8;r+=8}if((x&15)==0){x>>=4;r+=4}if((x&3)==0){x>>=2;r+=2}if((x&1)==0)++r;return r}function bnGetLowestSetBit(){for(var i=0;i<this.t;++i)if(this[i]!=0)return i*this.DB+lbit(this[i]);if(this.s<0)return this.t*this.DB;return-1}function cbit(x){var r=0;while(x!=0){x&=x-1;++r}return r}function bnBitCount(){var r=0,x=this.s&this.DM;for(var i=0;i<this.t;++i)r+=cbit(this[i]^x);return r}function bnTestBit(n){var j=Math.floor(n/this.DB);if(j>=this.t)return this.s!=0;return(this[j]&1<<n%this.DB)!=0}function bnpChangeBit(n,op){var r=BigInteger.ONE.shiftLeft(n);this.bitwiseTo(r,op,r);return r}function bnSetBit(n){return this.changeBit(n,op_or)}function bnClearBit(n){return this.changeBit(n,op_andnot)}function bnFlipBit(n){return this.changeBit(n,op_xor)}function bnpAddTo(a,r){var i=0,c=0,m=Math.min(a.t,this.t);while(i<m){c+=this[i]+a[i];r[i++]=c&this.DM;c>>=this.DB}if(a.t<this.t){c+=a.s;while(i<this.t){c+=this[i];r[i++]=c&this.DM;c>>=this.DB}c+=this.s}else{c+=this.s;while(i<a.t){c+=a[i];r[i++]=c&this.DM;c>>=this.DB}c+=a.s}r.s=c<0?-1:0;if(c>0)r[i++]=c;else if(c<-1)r[i++]=this.DV+c;r.t=i;r.clamp()}function bnAdd(a){var r=nbi();this.addTo(a,r);return r}function bnSubtract(a){var r=nbi();this.subTo(a,r);return r}function bnMultiply(a){var r=nbi();this.multiplyTo(a,r);return r}function bnSquare(){var r=nbi();this.squareTo(r);return r}function bnDivide(a){var r=nbi();this.divRemTo(a,r,null);return r}function bnRemainder(a){var r=nbi();this.divRemTo(a,null,r);return r}function bnDivideAndRemainder(a){var q=nbi(),r=nbi();this.divRemTo(a,q,r);return new Array(q,r)}function bnpDMultiply(n){this[this.t]=this.am(0,n-1,this,0,0,this.t);++this.t;this.clamp()}function bnpDAddOffset(n,w){if(n==0)return;while(this.t<=w)this[this.t++]=0;this[w]+=n;while(this[w]>=this.DV){this[w]-=this.DV;if(++w>=this.t)this[this.t++]=0;++this[w]}}function NullExp(){}function nNop(x){return x}function nMulTo(x,y,r){x.multiplyTo(y,r)}function nSqrTo(x,r){x.squareTo(r)}NullExp.prototype.convert=nNop;NullExp.prototype.revert=nNop;NullExp.prototype.mulTo=nMulTo;NullExp.prototype.sqrTo=nSqrTo;function bnPow(e){return this.exp(e,new NullExp)}function bnpMultiplyLowerTo(a,n,r){var i=Math.min(this.t+a.t,n);r.s=0;r.t=i;while(i>0)r[--i]=0;var j;for(j=r.t-this.t;i<j;++i)r[i+this.t]=this.am(0,a[i],r,i,0,this.t);for(j=Math.min(a.t,n);i<j;++i)this.am(0,a[i],r,i,0,n-i);r.clamp()}function bnpMultiplyUpperTo(a,n,r){--n;var i=r.t=this.t+a.t-n;r.s=0;while(--i>=0)r[i]=0;for(i=Math.max(n-this.t,0);i<a.t;++i)r[this.t+i-n]=this.am(n-i,a[i],r,0,0,this.t+i-n);r.clamp();r.drShiftTo(1,r)}function Barrett(m){this.r2=nbi();this.q3=nbi();BigInteger.ONE.dlShiftTo(2*m.t,this.r2);this.mu=this.r2.divide(m);this.m=m}function barrettConvert(x){if(x.s<0||x.t>2*this.m.t)return x.mod(this.m);else if(x.compareTo(this.m)<0)return x;else{var r=nbi();x.copyTo(r);this.reduce(r);return r}}function barrettRevert(x){return x}function barrettReduce(x){x.drShiftTo(this.m.t-1,this.r2);if(x.t>this.m.t+1){x.t=this.m.t+1;x.clamp()}this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3);this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(x.compareTo(this.r2)<0)x.dAddOffset(1,this.m.t+1);x.subTo(this.r2,x);while(x.compareTo(this.m)>=0)x.subTo(this.m,x)}function barrettSqrTo(x,r){x.squareTo(r);this.reduce(r)}function barrettMulTo(x,y,r){x.multiplyTo(y,r);this.reduce(r)}Barrett.prototype.convert=barrettConvert;Barrett.prototype.revert=barrettRevert;Barrett.prototype.reduce=barrettReduce;Barrett.prototype.mulTo=barrettMulTo;Barrett.prototype.sqrTo=barrettSqrTo;function bnModPow(e,m){var i=e.bitLength(),k,r=nbv(1),z;if(i<=0)return r;else if(i<18)k=1;else if(i<48)k=3;else if(i<144)k=4;else if(i<768)k=5;else k=6;if(i<8)z=new Classic(m);else if(m.isEven())z=new Barrett(m);else z=new Montgomery(m);var g=new Array,n=3,k1=k-1,km=(1<<k)-1;g[1]=z.convert(this);if(k>1){var g2=nbi();z.sqrTo(g[1],g2);while(n<=km){g[n]=nbi();z.mulTo(g2,g[n-2],g[n]);n+=2}}var j=e.t-1,w,is1=true,r2=nbi(),t;i=nbits(e[j])-1;while(j>=0){if(i>=k1)w=e[j]>>i-k1&km;else{w=(e[j]&(1<<i+1)-1)<<k1-i;if(j>0)w|=e[j-1]>>this.DB+i-k1}n=k;while((w&1)==0){w>>=1;--n}if((i-=n)<0){i+=this.DB;--j}if(is1){g[w].copyTo(r);is1=false}else{while(n>1){z.sqrTo(r,r2);z.sqrTo(r2,r);n-=2}if(n>0)z.sqrTo(r,r2);else{t=r;r=r2;r2=t}z.mulTo(r2,g[w],r)}while(j>=0&&(e[j]&1<<i)==0){z.sqrTo(r,r2);t=r;r=r2;r2=t;if(--i<0){i=this.DB-1;--j}}}return z.revert(r)}function bnGCD(a){var x=this.s<0?this.negate():this.clone();var y=a.s<0?a.negate():a.clone();if(x.compareTo(y)<0){var t=x;x=y;y=t}var i=x.getLowestSetBit(),g=y.getLowestSetBit();if(g<0)return x;if(i<g)g=i;if(g>0){x.rShiftTo(g,x);y.rShiftTo(g,y)}while(x.signum()>0){if((i=x.getLowestSetBit())>0)x.rShiftTo(i,x);if((i=y.getLowestSetBit())>0)y.rShiftTo(i,y);if(x.compareTo(y)>=0){x.subTo(y,x);x.rShiftTo(1,x)}else{y.subTo(x,y);y.rShiftTo(1,y)}}if(g>0)y.lShiftTo(g,y);return y}function bnpModInt(n){if(n<=0)return 0;var d=this.DV%n,r=this.s<0?n-1:0;if(this.t>0)if(d==0)r=this[0]%n;else for(var i=this.t-1;i>=0;--i)r=(d*r+this[i])%n;return r}function bnModInverse(m){var ac=m.isEven();if(this.isEven()&&ac||m.signum()==0)return BigInteger.ZERO;var u=m.clone(),v=this.clone();var a=nbv(1),b=nbv(0),c=nbv(0),d=nbv(1);while(u.signum()!=0){while(u.isEven()){u.rShiftTo(1,u);if(ac){if(!a.isEven()||!b.isEven()){a.addTo(this,a);b.subTo(m,b)}a.rShiftTo(1,a)}else if(!b.isEven())b.subTo(m,b);b.rShiftTo(1,b)}while(v.isEven()){v.rShiftTo(1,v);if(ac){if(!c.isEven()||!d.isEven()){c.addTo(this,c);d.subTo(m,d)}c.rShiftTo(1,c)}else if(!d.isEven())d.subTo(m,d);d.rShiftTo(1,d)}if(u.compareTo(v)>=0){u.subTo(v,u);if(ac)a.subTo(c,a);b.subTo(d,b)}else{v.subTo(u,v);if(ac)c.subTo(a,c);d.subTo(b,d)}}if(v.compareTo(BigInteger.ONE)!=0)return BigInteger.ZERO;if(d.compareTo(m)>=0)return d.subtract(m);if(d.signum()<0)d.addTo(m,d);else return d;if(d.signum()<0)return d.add(m);else return d}var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997];var lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(t){var i,x=this.abs();if(x.t==1&&x[0]<=lowprimes[lowprimes.length-1]){for(i=0;i<lowprimes.length;++i)if(x[0]==lowprimes[i])return true;return false}if(x.isEven())return false;i=1;while(i<lowprimes.length){var m=lowprimes[i],j=i+1;while(j<lowprimes.length&&m<lplim)m*=lowprimes[j++];m=x.modInt(m);while(i<j)if(m%lowprimes[i++]==0)return false}return x.millerRabin(t)}function bnpMillerRabin(t){var n1=this.subtract(BigInteger.ONE);var k=n1.getLowestSetBit();if(k<=0)return false;var r=n1.shiftRight(k);t=t+1>>1;if(t>lowprimes.length)t=lowprimes.length;var a=nbi();for(var i=0;i<t;++i){a.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var y=a.modPow(r,this);if(y.compareTo(BigInteger.ONE)!=0&&y.compareTo(n1)!=0){var j=1;while(j++<k&&y.compareTo(n1)!=0){y=y.modPowInt(2,this);if(y.compareTo(BigInteger.ONE)==0)return false}if(y.compareTo(n1)!=0)return false}}return true}BigInteger.prototype.chunkSize=bnpChunkSize;BigInteger.prototype.toRadix=bnpToRadix;BigInteger.prototype.fromRadix=bnpFromRadix;BigInteger.prototype.fromNumber=bnpFromNumber;BigInteger.prototype.bitwiseTo=bnpBitwiseTo;BigInteger.prototype.changeBit=bnpChangeBit;BigInteger.prototype.addTo=bnpAddTo;BigInteger.prototype.dMultiply=bnpDMultiply;BigInteger.prototype.dAddOffset=bnpDAddOffset;BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo;BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo;BigInteger.prototype.modInt=bnpModInt;BigInteger.prototype.millerRabin=bnpMillerRabin;BigInteger.prototype.clone=bnClone;BigInteger.prototype.intValue=bnIntValue;BigInteger.prototype.byteValue=bnByteValue;BigInteger.prototype.shortValue=bnShortValue;BigInteger.prototype.signum=bnSigNum;BigInteger.prototype.toByteArray=bnToByteArray;BigInteger.prototype.equals=bnEquals;BigInteger.prototype.min=bnMin;BigInteger.prototype.max=bnMax;BigInteger.prototype.and=bnAnd;BigInteger.prototype.or=bnOr;BigInteger.prototype.xor=bnXor;BigInteger.prototype.andNot=bnAndNot;BigInteger.prototype.not=bnNot;BigInteger.prototype.shiftLeft=bnShiftLeft;BigInteger.prototype.shiftRight=bnShiftRight;BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit;BigInteger.prototype.bitCount=bnBitCount;BigInteger.prototype.testBit=bnTestBit;BigInteger.prototype.setBit=bnSetBit;BigInteger.prototype.clearBit=bnClearBit;BigInteger.prototype.flipBit=bnFlipBit;BigInteger.prototype.add=bnAdd;BigInteger.prototype.subtract=bnSubtract;BigInteger.prototype.multiply=bnMultiply;BigInteger.prototype.divide=bnDivide;BigInteger.prototype.remainder=bnRemainder;BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder;BigInteger.prototype.modPow=bnModPow;BigInteger.prototype.modInverse=bnModInverse;BigInteger.prototype.pow=bnPow;BigInteger.prototype.gcd=bnGCD;BigInteger.prototype.isProbablePrime=bnIsProbablePrime;BigInteger.prototype.square=bnSquare;BigInteger.prototype.sqrt=function(){var div=BigInteger.ZERO.setBit(this.bitLength()/2);var div2=div;for(;;){var y=div.add(this.divide(div)).shiftRight(1);if(y.equals(div)||y.equals(div2))return y;div2=div;div=y}};var ASN1HEX=new function(){};ASN1HEX.getLblen=function(s,idx){if(s.substr(idx+2,1)!="8")return 1;var i=parseInt(s.substr(idx+3,1));if(i==0)return-1;if(0<i&&i<10)return i+1;return-2};ASN1HEX.getL=function(s,idx){var len=ASN1HEX.getLblen(s,idx);if(len<1)return"";return s.substr(idx+2,len*2)};ASN1HEX.getVblen=function(s,idx){var hLen,bi;hLen=ASN1HEX.getL(s,idx);if(hLen=="")return-1;if(hLen.substr(0,1)==="8"){bi=new BigInteger(hLen.substr(2),16)}else{bi=new BigInteger(hLen,16)}return bi.intValue()};ASN1HEX.getVidx=function(s,idx){var l_len=ASN1HEX.getLblen(s,idx);if(l_len<0)return l_len;return idx+(l_len+1)*2};ASN1HEX.getV=function(s,idx){var idx1=ASN1HEX.getVidx(s,idx);var blen=ASN1HEX.getVblen(s,idx);return s.substr(idx1,blen*2)};ASN1HEX.getTLV=function(s,idx){return s.substr(idx,2)+ASN1HEX.getL(s,idx)+ASN1HEX.getV(s,idx)};ASN1HEX.getTLVblen=function(h,idx){return 2+ASN1HEX.getLblen(h,idx)*2+ASN1HEX.getVblen(h,idx)*2};ASN1HEX.getNextSiblingIdx=function(s,idx){var idx1=ASN1HEX.getVidx(s,idx);var blen=ASN1HEX.getVblen(s,idx);return idx1+blen*2};ASN1HEX.getChildIdx=function(h,idx){var _ASN1HEX=ASN1HEX;var a=[];var idxStart,totalChildBlen,currentChildBlen;idxStart=_ASN1HEX.getVidx(h,idx);totalChildBlen=_ASN1HEX.getVblen(h,idx)*2;if(h.substr(idx,2)=="03"){idxStart+=2;totalChildBlen-=2}currentChildBlen=0;var i=idxStart;while(currentChildBlen<=totalChildBlen){var tlvBlen=_ASN1HEX.getTLVblen(h,i);currentChildBlen+=tlvBlen;if(currentChildBlen<=totalChildBlen)a.push(i);i+=tlvBlen;if(currentChildBlen>=totalChildBlen)break}return a};ASN1HEX.getNthChildIdx=function(h,idx,nth){var a=ASN1HEX.getChildIdx(h,idx);return a[nth]};ASN1HEX.getIdxbyList=function(h,currentIndex,nthList,checkingTag){var _ASN1HEX=ASN1HEX;var firstNth,a;if(nthList.length==0){if(checkingTag!==undefined){if(h.substr(currentIndex,2)!==checkingTag)return-1}return currentIndex}firstNth=nthList.shift();a=_ASN1HEX.getChildIdx(h,currentIndex);if(firstNth>=a.length)return-1;return _ASN1HEX.getIdxbyList(h,a[firstNth],nthList,checkingTag)};ASN1HEX.getIdxbyListEx=function(h,currentIndex,nthList,checkingTag){var _ASN1HEX=ASN1HEX;var firstNth,a;if(nthList.length==0){if(checkingTag!==undefined){if(h.substr(currentIndex,2)!==checkingTag){return-1}}return currentIndex}firstNth=nthList.shift();a=_ASN1HEX.getChildIdx(h,currentIndex);var count=0;for(var i=0;i<a.length;i++){var childTag=h.substr(a[i],2);if(typeof firstNth=="number"&&!_ASN1HEX.isContextTag(childTag)&&count==firstNth||typeof firstNth=="string"&&_ASN1HEX.isContextTag(childTag,firstNth)){return _ASN1HEX.getIdxbyListEx(h,a[i],nthList,checkingTag)}if(!_ASN1HEX.isContextTag(childTag))count++}return-1};ASN1HEX.getTLVbyList=function(h,currentIndex,nthList,checkingTag){var _ASN1HEX=ASN1HEX;var idx=_ASN1HEX.getIdxbyList(h,currentIndex,nthList,checkingTag);if(idx==-1)return null;if(idx>=h.length)return null;return _ASN1HEX.getTLV(h,idx)};ASN1HEX.getTLVbyListEx=function(h,currentIndex,nthList,checkingTag){var _ASN1HEX=ASN1HEX;var idx=_ASN1HEX.getIdxbyListEx(h,currentIndex,nthList,checkingTag);if(idx==-1)return null;return _ASN1HEX.getTLV(h,idx)};ASN1HEX.getVbyList=function(h,currentIndex,nthList,checkingTag,removeUnusedbits){var _ASN1HEX=ASN1HEX;var idx,v;idx=_ASN1HEX.getIdxbyList(h,currentIndex,nthList,checkingTag);if(idx==-1)return null;if(idx>=h.length)return null;v=_ASN1HEX.getV(h,idx);if(removeUnusedbits===true)v=v.substr(2);return v};ASN1HEX.getVbyListEx=function(h,currentIndex,nthList,checkingTag,removeUnusedbits){var _ASN1HEX=ASN1HEX;var idx,tlv,v;idx=_ASN1HEX.getIdxbyListEx(h,currentIndex,nthList,checkingTag);if(idx==-1)return null;v=_ASN1HEX.getV(h,idx);if(h.substr(idx,2)=="03"&&removeUnusedbits!==false)v=v.substr(2);return v};ASN1HEX.getInt=function(h,idx,errorReturn){if(errorReturn==undefined)errorReturn=-1;try{var hTag=h.substr(idx,2);if(hTag!="02"&&hTag!="03")return errorReturn;var hV=ASN1HEX.getV(h,idx);if(hTag=="02"){return parseInt(hV,16)}else{return bitstrtoint(hV)}}catch(ex){return errorReturn}};ASN1HEX.getOID=function(h,idx,errorReturn){if(errorReturn==undefined)errorReturn=null;try{if(h.substr(idx,2)!="06")return errorReturn;var hOID=ASN1HEX.getV(h,idx);return hextooid(hOID)}catch(ex){return errorReturn}};ASN1HEX.getOIDName=function(h,idx,errorReturn){if(errorReturn==undefined)errorReturn=null;try{var oid=ASN1HEX.getOID(h,idx,errorReturn);if(oid==errorReturn)return errorReturn;var name=KJUR.asn1.x509.OID.oid2name(oid);if(name=="")return oid;return name}catch(ex){return errorReturn}};ASN1HEX.getString=function(h,idx,errorReturn){if(errorReturn==undefined)errorReturn=null;try{var hV=ASN1HEX.getV(h,idx);return hextorstr(hV)}catch(ex){return errorReturn}};ASN1HEX.hextooidstr=function(hex){var zeroPadding=function(s,len){if(s.length>=len)return s;return new Array(len-s.length+1).join("0")+s};var a=[];var hex0=hex.substr(0,2);var i0=parseInt(hex0,16);a[0]=new String(Math.floor(i0/40));a[1]=new String(i0%40);var hex1=hex.substr(2);var b=[];for(var i=0;i<hex1.length/2;i++){b.push(parseInt(hex1.substr(i*2,2),16))}var c=[];var cbin="";for(var i=0;i<b.length;i++){if(b[i]&128){cbin=cbin+zeroPadding((b[i]&127).toString(2),7)}else{cbin=cbin+zeroPadding((b[i]&127).toString(2),7);c.push(new String(parseInt(cbin,2)));cbin=""}}var s=a.join(".");if(c.length>0)s=s+"."+c.join(".");return s};ASN1HEX.dump=function(hexOrObj,flags,idx,indent){var _ASN1HEX=ASN1HEX;var _getV=_ASN1HEX.getV;var _dump=_ASN1HEX.dump;var _getChildIdx=_ASN1HEX.getChildIdx;var hex=hexOrObj;if(hexOrObj instanceof KJUR.asn1.ASN1Object)hex=hexOrObj.tohex();var _skipLongHex=function(hex,limitNumOctet){if(hex.length<=limitNumOctet*2){return hex}else{var s=hex.substr(0,limitNumOctet)+"..(total "+hex.length/2+"bytes).."+hex.substr(hex.length-limitNumOctet,limitNumOctet);return s}};if(flags===undefined)flags={ommit_long_octet:32};if(idx===undefined)idx=0;if(indent===undefined)indent="";var skipLongHex=flags.ommit_long_octet;var tag=hex.substr(idx,2);if(tag=="01"){var v=_getV(hex,idx);if(v=="00"){return indent+"BOOLEAN FALSE\n"}else{return indent+"BOOLEAN TRUE\n"}}if(tag=="02"){var v=_getV(hex,idx);return indent+"INTEGER "+_skipLongHex(v,skipLongHex)+"\n"}if(tag=="03"){var v=_getV(hex,idx);if(_ASN1HEX.isASN1HEX(v.substr(2))){var s=indent+"BITSTRING, encapsulates\n";s=s+_dump(v.substr(2),flags,0,indent+"  ");return s}else{return indent+"BITSTRING "+_skipLongHex(v,skipLongHex)+"\n"}}if(tag=="04"){var v=_getV(hex,idx);if(_ASN1HEX.isASN1HEX(v)){var s=indent+"OCTETSTRING, encapsulates\n";s=s+_dump(v,flags,0,indent+"  ");return s}else{return indent+"OCTETSTRING "+_skipLongHex(v,skipLongHex)+"\n"}}if(tag=="05"){return indent+"NULL\n"}if(tag=="06"){var hV=_getV(hex,idx);var oidDot=KJUR.asn1.ASN1Util.oidHexToInt(hV);var oidName=KJUR.asn1.x509.OID.oid2name(oidDot);var oidSpc=oidDot.replace(/\./g," ");if(oidName!=""){return indent+"ObjectIdentifier "+oidName+" ("+oidSpc+")\n"}else{return indent+"ObjectIdentifier ("+oidSpc+")\n"}}if(tag=="0a"){return indent+"ENUMERATED "+parseInt(_getV(hex,idx))+"\n"}if(tag=="0c"){return indent+"UTF8String '"+hextoutf8(_getV(hex,idx))+"'\n"}if(tag=="13"){return indent+"PrintableString '"+hextoutf8(_getV(hex,idx))+"'\n"}if(tag=="14"){return indent+"TeletexString '"+hextoutf8(_getV(hex,idx))+"'\n"}if(tag=="16"){return indent+"IA5String '"+hextoutf8(_getV(hex,idx))+"'\n"}if(tag=="17"){return indent+"UTCTime "+hextoutf8(_getV(hex,idx))+"\n"}if(tag=="18"){return indent+"GeneralizedTime "+hextoutf8(_getV(hex,idx))+"\n"}if(tag=="1a"){return indent+"VisualString '"+hextoutf8(_getV(hex,idx))+"'\n"}if(tag=="1e"){return indent+"BMPString '"+ucs2hextoutf8(_getV(hex,idx))+"'\n"}if(tag=="30"){if(hex.substr(idx,4)=="3000"){return indent+"SEQUENCE {}\n"}var s=indent+"SEQUENCE\n";var aIdx=_getChildIdx(hex,idx);var flagsTemp=flags;if((aIdx.length==2||aIdx.length==3)&&hex.substr(aIdx[0],2)=="06"&&hex.substr(aIdx[aIdx.length-1],2)=="04"){var oidName=_ASN1HEX.oidname(_getV(hex,aIdx[0]));var flagsClone=JSON.parse(JSON.stringify(flags));flagsClone.x509ExtName=oidName;flagsTemp=flagsClone}for(var i=0;i<aIdx.length;i++){s=s+_dump(hex,flagsTemp,aIdx[i],indent+"  ")}return s}if(tag=="31"){var s=indent+"SET\n";var aIdx=_getChildIdx(hex,idx);for(var i=0;i<aIdx.length;i++){s=s+_dump(hex,flags,aIdx[i],indent+"  ")}return s}var tag=parseInt(tag,16);if((tag&128)!=0){var tagNumber=tag&31;if((tag&32)!=0){var s=indent+"["+tagNumber+"]\n";var aIdx=_getChildIdx(hex,idx);for(var i=0;i<aIdx.length;i++){s=s+_dump(hex,flags,aIdx[i],indent+"  ")}return s}else{var v=_getV(hex,idx);if(ASN1HEX.isASN1HEX(v)){var s=indent+"["+tagNumber+"]\n";s=s+_dump(v,flags,0,indent+"  ");return s}else if(v.substr(0,8)=="68747470"){v=hextoutf8(v)}else if(flags.x509ExtName==="subjectAltName"&&tagNumber==2){v=hextoutf8(v)}var s=indent+"["+tagNumber+"] "+v+"\n";return s}}return indent+"UNKNOWN("+tag+") "+_getV(hex,idx)+"\n"};ASN1HEX.parse=function(h){var _ASN1HEX=ASN1HEX,_parse=_ASN1HEX.parse,_isASN1HEX=_ASN1HEX.isASN1HEX,_getV=_ASN1HEX.getV,_getTLV=_ASN1HEX.getTLV,_getChildIdx=_ASN1HEX.getChildIdx,_KJUR_asn1=KJUR.asn1,_oidHexToInt=_KJUR_asn1.ASN1Util.oidHexToInt,_oid2name=_KJUR_asn1.x509.OID.oid2name,_hextoutf8=hextoutf8,_ucs2hextoutf8=ucs2hextoutf8,_iso88591hextoutf8=iso88591hextoutf8;var tagName={"0c":"utf8str",12:"numstr",13:"prnstr",14:"telstr",16:"ia5str",17:"utctime",18:"gentime","1a":"visstr","1e":"bmpstr",30:"seq",31:"set"};var _parseChild=function(h){var result=[];var aIdx=_getChildIdx(h,0);for(var i=0;i<aIdx.length;i++){var idx=aIdx[i];var hTLV=_getTLV(h,idx);var pItem=_parse(hTLV);result.push(pItem)}return result};var tag=h.substr(0,2);var result={};var hV=_getV(h,0);if(tag=="01"){if(h=="0101ff")return{bool:true};return{bool:false}}else if(tag=="02"){return{int:{hex:hV}}}else if(tag=="03"){try{if(hV.substr(0,2)!="00")throw"not encap";var hV1=hV.substr(2);if(!_isASN1HEX(hV1))throw"not encap";return{bitstr:{obj:_parse(hV1)}}}catch(ex){var bV=null;if(hV.length<=10)bV=bitstrtobinstr(hV);if(bV==null){return{bitstr:{hex:hV}}}else{return{bitstr:{bin:bV}}}}}else if(tag=="04"){try{if(!_isASN1HEX(hV))throw"not encap";return{octstr:{obj:_parse(hV)}}}catch(ex){return{octstr:{hex:hV}}}}else if(tag=="05"){return{null:""}}else if(tag=="06"){var oidDot=_oidHexToInt(hV);var oidName=_oid2name(oidDot);if(oidName==""){return{oid:oidDot}}else{return{oid:oidName}}}else if(tag=="0a"){if(hV.length>4){return{enum:{hex:hV}}}else{return{enum:parseInt(hV,16)}}}else if(tag=="30"||tag=="31"){result[tagName[tag]]=_parseChild(h);return result}else if(tag=="14"){var s=_iso88591hextoutf8(hV);result[tagName[tag]]={str:s};return result}else if(tag=="1e"){var s=_ucs2hextoutf8(hV);result[tagName[tag]]={str:s};return result}else if(":0c:12:13:16:17:18:1a:".indexOf(tag)!=-1){var s=_hextoutf8(hV);result[tagName[tag]]={str:s};return result}else if(tag.match(/^8[0-9]$/)){var s=_hextoutf8(hV);if(s==null|s==""){return{tag:{tag:tag,explicit:false,hex:hV}}}else if(s.match(/[\x00-\x1F\x7F-\x9F]/)!=null||s.match(/[\u0000-\u001F\u0080â€“\u009F]/)!=null){return{tag:{tag:tag,explicit:false,hex:hV}}}else{return{tag:{tag:tag,explicit:false,str:s}}}}else if(tag.match(/^a[0-9]$/)){try{if(!_isASN1HEX(hV))throw new Error("not encap");return{tag:{tag:tag,explicit:true,obj:_parse(hV)}}}catch(ex){return{tag:{tag:tag,explicit:true,hex:hV}}}}else{var d=new KJUR.asn1.ASN1Object;d.hV=hV;var hL=d.getLengthHexFromValue();return{asn1:{tlv:tag+hL+hV}}}};ASN1HEX.isContextTag=function(hTag,sTag){hTag=hTag.toLowerCase();var ihtag,istag;try{ihtag=parseInt(hTag,16)}catch(ex){return-1}if(sTag===undefined){if((ihtag&192)==128){return true}else{return false}}try{var result=sTag.match(/^\[[0-9]+\]$/);if(result==null)return false;istag=parseInt(sTag.substr(1,sTag.length-1),10);if(istag>31)return false;if((ihtag&192)==128&&(ihtag&31)==istag){return true}return false}catch(ex){return false}};ASN1HEX.isASN1HEX=function(hex){var _ASN1HEX=ASN1HEX;if(hex.length%2==1)return false;var intL=_ASN1HEX.getVblen(hex,0);var hT=hex.substr(0,2);var hL=_ASN1HEX.getL(hex,0);var hVLength=hex.length-hT.length-hL.length;if(hVLength==intL*2)return true;return false};ASN1HEX.checkStrictDER=function(h,idx,maxHexLen,maxByteLen,maxLbyteLen){var _ASN1HEX=ASN1HEX;if(maxHexLen===undefined){if(typeof h!="string")throw new Error("not hex string");h=h.toLowerCase();if(!KJUR.lang.String.isHex(h))throw new Error("not hex string");maxHexLen=h.length;maxByteLen=h.length/2;if(maxByteLen<128){maxLbyteLen=1}else{maxLbyteLen=Math.ceil(maxByteLen.toString(16))+1}}var hL=_ASN1HEX.getL(h,idx);if(hL.length>maxLbyteLen*2)throw new Error("L of TLV too long: idx="+idx);var vblen=_ASN1HEX.getVblen(h,idx);if(vblen>maxByteLen)throw new Error("value of L too long than hex: idx="+idx);var hTLV=_ASN1HEX.getTLV(h,idx);var hVLength=hTLV.length-2-_ASN1HEX.getL(h,idx).length;if(hVLength!==vblen*2)throw new Error("V string length and L's value not the same:"+hVLength+"/"+vblen*2);if(idx===0){if(h.length!=hTLV.length)throw new Error("total length and TLV length unmatch:"+h.length+"!="+hTLV.length)}var hT=h.substr(idx,2);if(hT==="02"){var vidx=_ASN1HEX.getVidx(h,idx);if(h.substr(vidx,2)=="00"&&h.charCodeAt(vidx+2)<56)throw new Error("not least zeros for DER INTEGER")}if(parseInt(hT,16)&32){var intL=_ASN1HEX.getVblen(h,idx);var sum=0;var aIdx=_ASN1HEX.getChildIdx(h,idx);for(var i=0;i<aIdx.length;i++){var tlv=_ASN1HEX.getTLV(h,aIdx[i]);sum+=tlv.length;_ASN1HEX.checkStrictDER(h,aIdx[i],maxHexLen,maxByteLen,maxLbyteLen)}if(intL*2!=sum)throw new Error("sum of children's TLV length and L unmatch: "+intL*2+"!="+sum)}};ASN1HEX.oidname=function(oidDotOrHex){var _KJUR_asn1=KJUR.asn1;if(KJUR.lang.String.isHex(oidDotOrHex))oidDotOrHex=_KJUR_asn1.ASN1Util.oidHexToInt(oidDotOrHex);var name=_KJUR_asn1.x509.OID.oid2name(oidDotOrHex);if(name==="")name=oidDotOrHex;return name};var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b64pad="=";function hex2b64(h){var i;var c;var ret="";for(i=0;i+3<=h.length;i+=3){c=parseInt(h.substring(i,i+3),16);ret+=b64map.charAt(c>>6)+b64map.charAt(c&63)}if(i+1==h.length){c=parseInt(h.substring(i,i+1),16);ret+=b64map.charAt(c<<2)}else if(i+2==h.length){c=parseInt(h.substring(i,i+2),16);ret+=b64map.charAt(c>>2)+b64map.charAt((c&3)<<4)}if(b64pad)while((ret.length&3)>0)ret+=b64pad;return ret}function b64tohex(s){var ret="";var i;var k=0;var slop;var v;for(i=0;i<s.length;++i){if(s.charAt(i)==b64pad)break;v=b64map.indexOf(s.charAt(i));if(v<0)continue;if(k==0){ret+=int2char(v>>2);slop=v&3;k=1}else if(k==1){ret+=int2char(slop<<2|v>>4);slop=v&15;k=2}else if(k==2){ret+=int2char(slop);ret+=int2char(v>>2);slop=v&3;k=3}else{ret+=int2char(slop<<2|v>>4);ret+=int2char(v&15);k=0}}if(k==1)ret+=int2char(slop<<2);return ret}function b64toBA(s){var h=b64tohex(s);var i;var a=new Array;for(i=0;2*i<h.length;++i){a[i]=parseInt(h.substring(2*i,2*i+2),16)}return a}var KJUR;if(typeof KJUR=="undefined"||!KJUR)KJUR={};if(typeof KJUR.lang=="undefined"||!KJUR.lang)KJUR.lang={};KJUR.lang.String=function(){};function Base64x(){}function stoBA(s){var a=new Array;for(var i=0;i<s.length;i++){a[i]=s.charCodeAt(i)}return a}function BAtos(a){var s="";for(var i=0;i<a.length;i++){s=s+String.fromCharCode(a[i])}return s}function BAtohex(a){var s="";for(var i=0;i<a.length;i++){var hex1=a[i].toString(16);if(hex1.length==1)hex1="0"+hex1;s=s+hex1}return s}function stohex(s){return BAtohex(stoBA(s))}function stob64(s){return hex2b64(stohex(s))}function stob64u(s){return b64tob64u(hex2b64(stohex(s)))}function b64utos(s){return BAtos(b64toBA(b64utob64(s)))}function b64tob64u(s){s=s.replace(/\=/g,"");s=s.replace(/\+/g,"-");s=s.replace(/\//g,"_");return s}function b64utob64(s){if(s.length%4==2)s=s+"==";else if(s.length%4==3)s=s+"=";s=s.replace(/-/g,"+");s=s.replace(/_/g,"/");return s}function hextob64u(s){if(s.length%2==1)s="0"+s;return b64tob64u(hex2b64(s))}function b64utohex(s){return b64tohex(b64utob64(s))}var utf8tob64u,b64utoutf8;if(typeof Buffer==="function"){utf8tob64u=function(s){return b64tob64u(Buffer.from(s,"utf8").toString("base64"))};b64utoutf8=function(s){return Buffer.from(b64utob64(s),"base64").toString("utf8")}}else{utf8tob64u=function(s){return hextob64u(uricmptohex(encodeURIComponentAll(s)))};b64utoutf8=function(s){return decodeURIComponent(hextouricmp(b64utohex(s)))}}function utf8tob64(s){return hex2b64(uricmptohex(encodeURIComponentAll(s)))}function b64toutf8(s){return decodeURIComponent(hextouricmp(b64tohex(s)))}function utf8tohex(s){return uricmptohex(encodeURIComponentAll(s)).toLowerCase()}function hextoutf8(s){try{return decodeURIComponent(hextouricmp(s))}catch(ex){return null}}function iso88591hextoutf8(h){return hextoutf8(iso88591hextoutf8hex(h))}function utf8toiso88591hex(s){return utf8hextoiso88591hex(utf8tohex(s))}function iso88591hextoutf8hex(h){var a=h.match(/.{1,2}/g);var a2=[];for(var i=0;i<a.length;i++){var di=parseInt(a[i],16);if(161<=di&&di<=191){a2.push("c2");a2.push(a[i])}else if(192<=di&&di<=255){a2.push("c3");a2.push((di-64).toString(16))}else{a2.push(a[i])}}return a2.join("")}function utf8hextoiso88591hex(h){var a=h.match(/.{1,2}/g);var a2=[];for(var i=0;i<a.length;i++){if(a[i]=="c2"){i++;a2.push(a[i])}else if(a[i]=="c3"){i++;var ci=a[i];var di=parseInt(a[i],16)+64;a2.push(di.toString(16))}else{a2.push(a[i])}}return a2.join("")}function hextorstr(sHex){var s="";for(var i=0;i<sHex.length-1;i+=2){s+=String.fromCharCode(parseInt(sHex.substr(i,2),16))}return s}function rstrtohex(s){var result="";for(var i=0;i<s.length;i++){result+=("0"+s.charCodeAt(i).toString(16)).slice(-2)}return result}function hextob64(s){return hex2b64(s)}function hextob64nl(s){return foldnl(hextob64(s),64)}function foldnl(s,n){s=s.replace(new RegExp("(.{"+n+"})","g"),"$1\r\n");s=s.replace(/\s+$/,"");return s}function b64nltohex(s){var b64=s.replace(/[^0-9A-Za-z\/+=]*/g,"");var hex=b64tohex(b64);return hex}function b64topem(b64,pemHeader){return"-----BEGIN "+pemHeader+"-----\r\n"+foldnl(b64,64)+"\r\n-----END "+pemHeader+"-----\r\n"}function hextopem(dataHex,pemHeader){return"-----BEGIN "+pemHeader+"-----\r\n"+foldnl(hextob64(dataHex),64)+"\r\n-----END "+pemHeader+"-----\r\n"}function pemtohex(s,sHead){if(s.indexOf("-----BEGIN ")==-1)throw new Error("can't find PEM header");if(sHead!==undefined){s=s.replace(new RegExp("^[^]*-----BEGIN "+sHead+"-----"),"");s=s.replace(new RegExp("-----END "+sHead+"-----[^]*$"),"")}else{s=s.replace(/^[^]*-----BEGIN [^-]+-----/,"");s=s.replace(/-----END [^-]+-----[^]*$/,"")}return b64nltohex(s)}function pemtob64(s){if(s.indexOf("-----BEGIN ")==-1||s.indexOf("-----END ")==-1)return null;s=s.replace(/^[\s\S]*?-----BEGIN [^-]+-----/m,"");s=s.replace(/-----END [\s\S]+$/m,"");s=s.replace(/\s+/g,"");return s.match(/^[0-9a-zA-Z+/=]+$/)?s:null}function hextoArrayBuffer(hex){if(hex.length%2!=0)throw"input is not even length";if(hex.match(/^[0-9A-Fa-f]+$/)==null)throw"input is not hexadecimal";var buffer=new ArrayBuffer(hex.length/2);var view=new DataView(buffer);for(var i=0;i<hex.length/2;i++){view.setUint8(i,parseInt(hex.substr(i*2,2),16))}return buffer}function ArrayBuffertohex(buffer){var hex="";var view=new DataView(buffer);for(var i=0;i<buffer.byteLength;i++){hex+=("00"+view.getUint8(i).toString(16)).slice(-2)}return hex}function zulutomsec(s){var year,month,day,hour,min,sec,msec,d;var sYear,sFrac,sMsec,matchResult;s=timetogen(s);matchResult=s.match(/^(\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/);if(matchResult){year=parseInt(matchResult[1]);month=parseInt(matchResult[2])-1;day=parseInt(matchResult[3]);hour=parseInt(matchResult[4]);min=parseInt(matchResult[5]);sec=parseInt(matchResult[6]);msec=0;sFrac=matchResult[7];if(sFrac!==""){sMsec=(sFrac.substr(1)+"00").substr(0,3);msec=parseInt(sMsec)}return Date.UTC(year,month,day,hour,min,sec,msec)}throw new Error("unsupported zulu format: "+s)}function msectozulu(n){var d=new Date(n),year=("0000"+d.getUTCFullYear()).slice(-4),mon=("00"+(d.getUTCMonth()+1)).slice(-2),day=("00"+d.getUTCDate()).slice(-2),hour=("00"+d.getUTCHours()).slice(-2),min=("00"+d.getUTCMinutes()).slice(-2),sec=("00"+d.getUTCSeconds()).slice(-2),msec=("000"+d.getUTCMilliseconds()).slice(-3);msec=msec.replace(/0+$/,"");msec=msec!=""?"."+msec:msec;return year+mon+day+hour+min+sec+msec+"Z"}function zulutosec(s){return Math.round(zulutomsec(s)/1e3)}function zulutodate(s){return new Date(zulutomsec(s))}function datetozulu(d,flagUTCTime,flagMilli){var s;var year=d.getUTCFullYear();if(flagUTCTime){if(year<1950||2049<year)throw"not proper year for UTCTime: "+year;s=(""+year).slice(-2)}else{s=("000"+year).slice(-4)}s+=("0"+(d.getUTCMonth()+1)).slice(-2);s+=("0"+d.getUTCDate()).slice(-2);s+=("0"+d.getUTCHours()).slice(-2);s+=("0"+d.getUTCMinutes()).slice(-2);s+=("0"+d.getUTCSeconds()).slice(-2);if(flagMilli){var milli=d.getUTCMilliseconds();if(milli!==0){milli=("00"+milli).slice(-3);milli=milli.replace(/0+$/g,"");s+="."+milli}}s+="Z";return s}function timetogen(s){if(s.match(/^[0-9]{12}Z$/)||s.match(/^[0-9]{12}[.][0-9]*Z$/)){return s.match(/^[0-4]/)?"20"+s:"19"+s}return s}function uricmptohex(s){return s.replace(/%/g,"")}function hextouricmp(s){return s.replace(/(..)/g,"%$1")}function ipv6tohex(s){var msgMalformedAddress="malformed IPv6 address";if(!s.match(/^[0-9A-Fa-f:]+$/))throw msgMalformedAddress;s=s.toLowerCase();var num_colon=s.split(":").length-1;if(num_colon<2)throw msgMalformedAddress;var colon_replacer=":".repeat(7-num_colon+2);s=s.replace("::",colon_replacer);var a=s.split(":");if(a.length!=8)throw msgMalformedAddress;for(var i=0;i<8;i++){a[i]=("0000"+a[i]).slice(-4)}return a.join("")}function hextoipv6(s){if(!s.match(/^[0-9A-Fa-f]{32}$/))throw new Error("malformed IPv6 address: "+s);s=s.toLowerCase();var a=s.match(/.{1,4}/g);a=a.map(function(s){return s.replace(/^0+/,"")});a=a.map(function(s){return s==""?"0":s});s=":"+a.join(":")+":";var aZero=s.match(/:(0:){2,}/g);if(aZero==null)return s.slice(1,-1);var sMaxZero=aZero.sort().slice(-1)[0];s=s.replace(sMaxZero.substr(0,sMaxZero.length-1),":");if(s.substr(0,2)!="::")s=s.substr(1);if(s.substr(-2,2)!="::")s=s.substr(0,s.length-1);return s}function hextoip(s){var malformedErr=new Error("malformed hex value");if(!s.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw malformedErr;if(s.length==8){var ip;try{ip=parseInt(s.substr(0,2),16)+"."+parseInt(s.substr(2,2),16)+"."+parseInt(s.substr(4,2),16)+"."+parseInt(s.substr(6,2),16);return ip}catch(ex){throw malformedErr}}else if(s.length==16){try{return hextoip(s.substr(0,8))+"/"+ipprefixlen(s.substr(8))}catch(ex){throw malformedErr}}else if(s.length==32){return hextoipv6(s)}else if(s.length==64){try{return hextoipv6(s.substr(0,32))+"/"+ipprefixlen(s.substr(32))}catch(ex){throw malformedErr}return}else{return s}}function ipprefixlen(hMask){var malformedErr=new Error("malformed mask");var bMask;try{bMask=new BigInteger(hMask,16).toString(2)}catch(ex){throw malformedErr}if(!bMask.match(/^1*0*$/))throw malformedErr;return bMask.replace(/0+$/,"").length}function iptohex(s){var malformedErr=new Error("malformed IP address");s=s.toLowerCase(s);if(!s.match(/^[0-9a-f.:/]+$/))throw malformedErr;if(s.match(/^[0-9.]+$/)){var a=s.split(".");if(a.length!==4)throw malformedErr;var hex="";try{for(var i=0;i<4;i++){var d=parseInt(a[i]);hex+=("0"+d.toString(16)).slice(-2)}return hex}catch(ex){throw malformedErr}}else if(s.match(/^[0-9.]+\/[0-9]+$/)){var aItem=s.split("/");return iptohex(aItem[0])+ipnetmask(parseInt(aItem[1]),32)}else if(s.match(/^[0-9a-f:]+$/)&&s.indexOf(":")!==-1){return ipv6tohex(s)}else if(s.match(/^[0-9a-f:]+\/[0-9]+$/)&&s.indexOf(":")!==-1){var aItem=s.split("/");return ipv6tohex(aItem[0])+ipnetmask(parseInt(aItem[1]),128)}else{throw malformedErr}}function ipnetmask(prefixlen,len){if(len==32&&prefixlen==0)return"00000000";if(len==128&&prefixlen==0)return"00000000000000000000000000000000";var b=Array(prefixlen+1).join("1")+Array(len-prefixlen+1).join("0");return new BigInteger(b,2).toString(16)}function ucs2hextoutf8(s){function _conv(s){var i1=parseInt(s.substr(0,2),16);var i2=parseInt(s.substr(2),16);if(i1==0&i2<128){return String.fromCharCode(i2)}if(i1<8){var u1=192|(i1&7)<<3|(i2&192)>>6;var u2=128|i2&63;return hextoutf8(u1.toString(16)+u2.toString(16))}var u1=224|(i1&240)>>4;var u2=128|(i1&15)<<2|(i2&192)>>6;var u3=128|i2&63;return hextoutf8(u1.toString(16)+u2.toString(16)+u3.toString(16))}var a=s.match(/.{4}/g);var a2=a.map(_conv);return a2.join("")}function encodeURIComponentAll(u8){var s=encodeURIComponent(u8);var s2="";for(var i=0;i<s.length;i++){if(s[i]=="%"){s2=s2+s.substr(i,3);i=i+2}else{s2=s2+"%"+stohex(s[i])}}return s2}function newline_toUnix(s){s=s.replace(/\r\n/gm,"\n");return s}function newline_toDos(s){s=s.replace(/\r\n/gm,"\n");s=s.replace(/\n/gm,"\r\n");return s}KJUR.lang.String.isInteger=function(s){if(s.match(/^[0-9]+$/)){return true}else if(s.match(/^-[0-9]+$/)){return true}else{return false}};KJUR.lang.String.isHex=function(s){return ishex(s)};function ishex(s){if(s.length%2==0&&(s.match(/^[0-9a-f]+$/)||s.match(/^[0-9A-F]+$/))){return true}else{return false}}KJUR.lang.String.isBase64=function(s){s=s.replace(/\s+/g,"");if(s.match(/^[0-9A-Za-z+\/]+={0,3}$/)&&s.length%4==0){return true}else{return false}};KJUR.lang.String.isBase64URL=function(s){if(s.match(/[+/=]/))return false;s=b64utob64(s);return KJUR.lang.String.isBase64(s)};function isBase64URLDot(s){if(s.match(/^[0-9A-Za-z-_.]+$/))return true;return false}KJUR.lang.String.isIntegerArray=function(s){s=s.replace(/\s+/g,"");if(s.match(/^\[[0-9,]+\]$/)){return true}else{return false}};KJUR.lang.String.isPrintable=function(s){if(s.match(/^[0-9A-Za-z '()+,-./:=?]*$/)!==null)return true;return false};KJUR.lang.String.isIA5=function(s){if(s.match(/^[\x20-\x21\x23-\x7f]*$/)!==null)return true;return false};KJUR.lang.String.isMail=function(s){if(s.match(/^[A-Za-z0-9]{1}[A-Za-z0-9_.-]*@{1}[A-Za-z0-9_.-]{1,}\.[A-Za-z0-9]{1,}$/)!==null)return true;return false};function hextoposhex(s){if(s.length%2==1)return"0"+s;if(s.substr(0,1)>"7")return"00"+s;return s}function intarystrtohex(s){s=s.replace(/^\s*\[\s*/,"");s=s.replace(/\s*\]\s*$/,"");s=s.replace(/\s*/g,"");try{var hex=s.split(/,/).map(function(element,index,array){var i=parseInt(element);if(i<0||255<i)throw"integer not in range 0-255";var hI=("00"+i.toString(16)).slice(-2);return hI}).join("");return hex}catch(ex){throw"malformed integer array string: "+ex}}var strdiffidx=function(s1,s2){var n=s1.length;if(s1.length>s2.length)n=s2.length;for(var i=0;i<n;i++){if(s1.charCodeAt(i)!=s2.charCodeAt(i))return i}if(s1.length!=s2.length)return n;return-1};function oidtohex(oidString){var itox=function(i){var h=i.toString(16);if(h.length==1)h="0"+h;return h};var roidtox=function(roid){var h="";var bi=parseInt(roid,10);var b=bi.toString(2);var padLen=7-b.length%7;if(padLen==7)padLen=0;var bPad="";for(var i=0;i<padLen;i++)bPad+="0";b=bPad+b;for(var i=0;i<b.length-1;i+=7){var b8=b.substr(i,7);if(i!=b.length-7)b8="1"+b8;h+=itox(parseInt(b8,2))}return h};try{if(!oidString.match(/^[0-9.]+$/))return null;var h="";var a=oidString.split(".");var i0=parseInt(a[0],10)*40+parseInt(a[1],10);h+=itox(i0);a.splice(0,2);for(var i=0;i<a.length;i++){h+=roidtox(a[i])}return h}catch(ex){return null}}function hextooid(h){if(!ishex(h))return null;try{var a=[];var hex0=h.substr(0,2);var i0=parseInt(hex0,16);a[0]=new String(Math.floor(i0/40));a[1]=new String(i0%40);var hex1=h.substr(2);var b=[];for(var i=0;i<hex1.length/2;i++){b.push(parseInt(hex1.substr(i*2,2),16))}var c=[];var cbin="";for(var i=0;i<b.length;i++){if(b[i]&128){cbin=cbin+strpad((b[i]&127).toString(2),7)}else{cbin=cbin+strpad((b[i]&127).toString(2),7);c.push(new String(parseInt(cbin,2)));cbin=""}}var s=a.join(".");if(c.length>0)s=s+"."+c.join(".");return s}catch(ex){return null}}var strpad=function(s,len,padchar){if(padchar==undefined)padchar="0";if(s.length>=len)return s;return new Array(len-s.length+1).join(padchar)+s};function bitstrtoint(h){if(h.length%2!=0)return-1;h=h.toLowerCase();if(h.match(/^[0-9a-f]+$/)==null)return-1;try{var hUnusedbit=h.substr(0,2);if(hUnusedbit=="00")return parseInt(h.substr(2),16);var iUnusedbit=parseInt(hUnusedbit,16);if(iUnusedbit>7)return-1;var hValue=h.substr(2);var bValue=parseInt(hValue,16).toString(2);if(bValue=="0")bValue="00000000";bValue=bValue.slice(0,0-iUnusedbit);var iValue=parseInt(bValue,2);if(iValue==NaN)return-1;return iValue}catch(ex){return-1}}function inttobitstr(n){if(typeof n!="number")return null;if(n<0)return null;var bValue=Number(n).toString(2);var iUnusedbit=8-bValue.length%8;if(iUnusedbit==8)iUnusedbit=0;bValue=bValue+strpad("",iUnusedbit,"0");var hValue=parseInt(bValue,2).toString(16);if(hValue.length%2==1)hValue="0"+hValue;var hUnusedbit="0"+iUnusedbit;return hUnusedbit+hValue}function bitstrtobinstr(h){if(typeof h!="string")return null;if(h.length%2!=0)return null;if(!h.match(/^[0-9a-f]+$/))return null;try{var unusedBits=parseInt(h.substr(0,2),16);if(unusedBits<0||7<unusedBits)return null;var value=h.substr(2);var bin="";for(var i=0;i<value.length;i+=2){var hi=value.substr(i,2);var bi=parseInt(hi,16).toString(2);bi=("0000000"+bi).slice(-8);bin+=bi}return bin.substr(0,bin.length-unusedBits)}catch(ex){return null}}function binstrtobitstr(s){if(typeof s!="string")return null;if(s.match(/^[01]+$/)==null)return null;try{var n=parseInt(s,2);return inttobitstr(n)}catch(ex){return null}}function namearraytobinstr(namearray,namedb){var d=0;for(var i=0;i<namearray.length;i++){d|=1<<namedb[namearray[i]]}var s=d.toString(2);var r="";for(var i=s.length-1;i>=0;i--){r+=s[i]}return r}function aryval(val,keys,def){if(typeof val!="object")return undefined;var keys=String(keys).split(".");for(var i=0;i<keys.length&&val;i++){var key=keys[i];if(key.match(/^[0-9]+$/))key=parseInt(key);val=val[key]}return val||val===false?val:def}function extendClass(subClass,superClass){var F=function(){};F.prototype=superClass.prototype;subClass.prototype=new F;subClass.prototype.constructor=subClass;subClass.superclass=superClass.prototype;if(superClass.prototype.constructor==Object.prototype.constructor){superClass.prototype.constructor=superClass}}RSAKey.getPosArrayOfChildrenFromHex=function(hPrivateKey){return ASN1HEX.getChildIdx(hPrivateKey,0)};RSAKey.getHexValueArrayOfChildrenFromHex=function(hPrivateKey){var _ASN1HEX=ASN1HEX;var _getV=_ASN1HEX.getV;var a=RSAKey.getPosArrayOfChildrenFromHex(hPrivateKey);var h_v=_getV(hPrivateKey,a[0]);var h_n=_getV(hPrivateKey,a[1]);var h_e=_getV(hPrivateKey,a[2]);var h_d=_getV(hPrivateKey,a[3]);var h_p=_getV(hPrivateKey,a[4]);var h_q=_getV(hPrivateKey,a[5]);var h_dp=_getV(hPrivateKey,a[6]);var h_dq=_getV(hPrivateKey,a[7]);var h_co=_getV(hPrivateKey,a[8]);var a=new Array;a.push(h_v,h_n,h_e,h_d,h_p,h_q,h_dp,h_dq,h_co);return a};RSAKey.prototype.readPrivateKeyFromPEMString=function(keyPEM){var keyHex=pemtohex(keyPEM);var a=RSAKey.getHexValueArrayOfChildrenFromHex(keyHex);this.setPrivateEx(a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8])};RSAKey.prototype.readPKCS5PrvKeyHex=function(h){var a=RSAKey.getHexValueArrayOfChildrenFromHex(h);this.setPrivateEx(a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8])};RSAKey.prototype.readPKCS8PrvKeyHex=function(h){var hN,hE,hD,hP,hQ,hDP,hDQ,hCO;var _ASN1HEX=ASN1HEX;var _getVbyListEx=_ASN1HEX.getVbyListEx;if(_ASN1HEX.isASN1HEX(h)===false)throw new Error("not ASN.1 hex string");try{hN=_getVbyListEx(h,0,[2,0,1],"02");hE=_getVbyListEx(h,0,[2,0,2],"02");hD=_getVbyListEx(h,0,[2,0,3],"02");hP=_getVbyListEx(h,0,[2,0,4],"02");hQ=_getVbyListEx(h,0,[2,0,5],"02");hDP=_getVbyListEx(h,0,[2,0,6],"02");hDQ=_getVbyListEx(h,0,[2,0,7],"02");hCO=_getVbyListEx(h,0,[2,0,8],"02")}catch(ex){throw new Error("malformed PKCS#8 plain RSA private key")}this.setPrivateEx(hN,hE,hD,hP,hQ,hDP,hDQ,hCO)};RSAKey.prototype.readPKCS5PubKeyHex=function(h){var _ASN1HEX=ASN1HEX;var _getV=_ASN1HEX.getV;if(_ASN1HEX.isASN1HEX(h)===false)throw new Error("keyHex is not ASN.1 hex string");var aIdx=_ASN1HEX.getChildIdx(h,0);if(aIdx.length!==2||h.substr(aIdx[0],2)!=="02"||h.substr(aIdx[1],2)!=="02")throw new Error("wrong hex for PKCS#5 public key");var hN=_getV(h,aIdx[0]);var hE=_getV(h,aIdx[1]);this.setPublic(hN,hE)};RSAKey.prototype.readPKCS8PubKeyHex=function(h){var _ASN1HEX=ASN1HEX;if(_ASN1HEX.isASN1HEX(h)===false)throw new Error("not ASN.1 hex string");if(_ASN1HEX.getTLVbyListEx(h,0,[0,0])!=="06092a864886f70d010101")throw new Error("not PKCS8 RSA public key");var p5hex=_ASN1HEX.getTLVbyListEx(h,0,[1,0]);this.readPKCS5PubKeyHex(p5hex)};RSAKey.prototype.readCertPubKeyHex=function(h,nthPKI){var x,hPub;x=new X509;x.readCertHex(h);hPub=x.getPublicKeyHex();this.readPKCS8PubKeyHex(hPub)};"use strict";var sjcl={cipher:{},hash:{},keyexchange:{},mode:{},misc:{},codec:{},exception:{corrupt:function(message){this.toString=function(){return"CORRUPT: "+this.message};this.message=message},invalid:function(message){this.toString=function(){return"INVALID: "+this.message};this.message=message},bug:function(message){this.toString=function(){return"BUG: "+this.message};this.message=message},notReady:function(message){this.toString=function(){return"NOT READY: "+this.message};this.message=message}}};sjcl.cipher.aes=function(key){if(!this._tables[0][0][0]){this._precompute()}var i,j,tmp,encKey,decKey,sbox=this._tables[0][4],decTable=this._tables[1],keyLen=key.length,rcon=1;if(keyLen!==4&&keyLen!==6&&keyLen!==8){throw new sjcl.exception.invalid("invalid aes key size")}this._key=[encKey=key.slice(0),decKey=[]];for(i=keyLen;i<4*keyLen+28;i++){tmp=encKey[i-1];if(i%keyLen===0||keyLen===8&&i%keyLen===4){tmp=sbox[tmp>>>24]<<24^sbox[tmp>>16&255]<<16^sbox[tmp>>8&255]<<8^sbox[tmp&255];if(i%keyLen===0){tmp=tmp<<8^tmp>>>24^rcon<<24;rcon=rcon<<1^(rcon>>7)*283}}encKey[i]=encKey[i-keyLen]^tmp}for(j=0;i;j++,i--){tmp=encKey[j&3?i:i-4];if(i<=4||j<4){decKey[j]=tmp}else{decKey[j]=decTable[0][sbox[tmp>>>24]]^decTable[1][sbox[tmp>>16&255]]^decTable[2][sbox[tmp>>8&255]]^decTable[3][sbox[tmp&255]]}}};sjcl.cipher.aes.prototype={encrypt:function(data){return this._crypt(data,0)},decrypt:function(data){return this._crypt(data,1)},_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var encTable=this._tables[0],decTable=this._tables[1],sbox=encTable[4],sboxInv=decTable[4],i,x,xInv,d=[],th=[],x2,x4,x8,s,tEnc,tDec;for(i=0;i<256;i++){th[(d[i]=i<<1^(i>>7)*283)^i]=i}for(x=xInv=0;!sbox[x];x^=x2||1,xInv=th[xInv]||1){s=xInv^xInv<<1^xInv<<2^xInv<<3^xInv<<4;s=s>>8^s&255^99;sbox[x]=s;sboxInv[s]=x;x8=d[x4=d[x2=d[x]]];tDec=x8*16843009^x4*65537^x2*257^x*16843008;tEnc=d[s]*257^s*16843008;for(i=0;i<4;i++){encTable[i][x]=tEnc=tEnc<<24^tEnc>>>8;decTable[i][s]=tDec=tDec<<24^tDec>>>8}}for(i=0;i<5;i++){encTable[i]=encTable[i].slice(0);decTable[i]=decTable[i].slice(0)}},_crypt:function(input,dir){if(input.length!==4){throw new sjcl.exception.invalid("invalid aes block size")}var key=this._key[dir],a=input[0]^key[0],b=input[dir?3:1]^key[1],c=input[2]^key[2],d=input[dir?1:3]^key[3],a2,b2,c2,nInnerRounds=key.length/4-2,i,kIndex=4,out=[0,0,0,0],table=this._tables[dir],t0=table[0],t1=table[1],t2=table[2],t3=table[3],sbox=table[4];for(i=0;i<nInnerRounds;i++){a2=t0[a>>>24]^t1[b>>16&255]^t2[c>>8&255]^t3[d&255]^key[kIndex];b2=t0[b>>>24]^t1[c>>16&255]^t2[d>>8&255]^t3[a&255]^key[kIndex+1];c2=t0[c>>>24]^t1[d>>16&255]^t2[a>>8&255]^t3[b&255]^key[kIndex+2];d=t0[d>>>24]^t1[a>>16&255]^t2[b>>8&255]^t3[c&255]^key[kIndex+3];kIndex+=4;a=a2;b=b2;c=c2}for(i=0;i<4;i++){out[dir?3&-i:i]=sbox[a>>>24]<<24^sbox[b>>16&255]<<16^sbox[c>>8&255]<<8^sbox[d&255]^key[kIndex++];a2=a;a=b;b=c;c=d;d=a2}return out}};sjcl.bitArray={bitSlice:function(a,bstart,bend){a=sjcl.bitArray._shiftRight(a.slice(bstart/32),32-(bstart&31)).slice(1);return bend===undefined?a:sjcl.bitArray.clamp(a,bend-bstart)},extract:function(a,bstart,blength){var x,sh=Math.floor(-bstart-blength&31);if((bstart+blength-1^bstart)&-32){x=a[bstart/32|0]<<32-sh^a[bstart/32+1|0]>>>sh}else{x=a[bstart/32|0]>>>sh}return x&(1<<blength)-1},concat:function(a1,a2){if(a1.length===0||a2.length===0){return a1.concat(a2)}var last=a1[a1.length-1],shift=sjcl.bitArray.getPartial(last);if(shift===32){return a1.concat(a2)}else{return sjcl.bitArray._shiftRight(a2,shift,last|0,a1.slice(0,a1.length-1))}},bitLength:function(a){var l=a.length,x;if(l===0){return 0}x=a[l-1];return(l-1)*32+sjcl.bitArray.getPartial(x)},clamp:function(a,len){if(a.length*32<len){return a}a=a.slice(0,Math.ceil(len/32));var l=a.length;len=len&31;if(l>0&&len){a[l-1]=sjcl.bitArray.partial(len,a[l-1]&2147483648>>len-1,1)}return a},partial:function(len,x,_end){if(len===32){return x}return(_end?x|0:x<<32-len)+len*1099511627776},getPartial:function(x){return Math.round(x/1099511627776)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b)){return false}var x=0,i;for(i=0;i<a.length;i++){x|=a[i]^b[i]}return x===0},_shiftRight:function(a,shift,carry,out){var i,last2=0,shift2;if(out===undefined){out=[]}for(;shift>=32;shift-=32){out.push(carry);carry=0}if(shift===0){return out.concat(a)}for(i=0;i<a.length;i++){out.push(carry|a[i]>>>shift);carry=a[i]<<32-shift}last2=a.length?a[a.length-1]:0;shift2=sjcl.bitArray.getPartial(last2);out.push(sjcl.bitArray.partial(shift+shift2&31,shift+shift2>32?carry:out.pop(),1));return out},_xor4:function(x,y){return[x[0]^y[0],x[1]^y[1],x[2]^y[2],x[3]^y[3]]},byteswapM:function(a){var i,v,m=65280;for(i=0;i<a.length;++i){v=a[i];a[i]=v>>>24|v>>>8&m|(v&m)<<8|v<<24}return a}};sjcl.codec.utf8String={fromBits:function(arr){var out="",bl=sjcl.bitArray.bitLength(arr),i,tmp;for(i=0;i<bl/8;i++){if((i&3)===0){tmp=arr[i/4]}out+=String.fromCharCode(tmp>>>8>>>8>>>8);tmp<<=8}return decodeURIComponent(escape(out))},toBits:function(str){str=unescape(encodeURIComponent(str));var out=[],i,tmp=0;for(i=0;i<str.length;i++){tmp=tmp<<8|str.charCodeAt(i);if((i&3)===3){out.push(tmp);tmp=0}}if(i&3){out.push(sjcl.bitArray.partial(8*(i&3),tmp))}return out}};sjcl.codec.hex={fromBits:function(arr){var out="",i;for(i=0;i<arr.length;i++){out+=((arr[i]|0)+0xf00000000000).toString(16).substr(4)}return out.substr(0,sjcl.bitArray.bitLength(arr)/4)},toBits:function(str){var i,out=[],len;str=str.replace(/\s|0x/g,"");len=str.length;str=str+"00000000";for(i=0;i<str.length;i+=8){out.push(parseInt(str.substr(i,8),16)^0)}return sjcl.bitArray.clamp(out,len*4)}};sjcl.codec.base64={_chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fromBits:function(arr,_noEquals,_url){var out="",i,bits=0,c=sjcl.codec.base64._chars,ta=0,bl=sjcl.bitArray.bitLength(arr);if(_url){c=c.substr(0,62)+"-_"}for(i=0;out.length*6<bl;){out+=c.charAt((ta^arr[i]>>>bits)>>>26);if(bits<6){ta=arr[i]<<6-bits;bits+=26;i++}else{ta<<=6;bits-=6}}while(out.length&3&&!_noEquals){out+="="}return out},toBits:function(str,_url){str=str.replace(/\s|=/g,"");var out=[],i,bits=0,c=sjcl.codec.base64._chars,ta=0,x;if(_url){c=c.substr(0,62)+"-_"}for(i=0;i<str.length;i++){x=c.indexOf(str.charAt(i));if(x<0){throw new sjcl.exception.invalid("this isn't base64!")}if(bits>26){bits-=26;out.push(ta^x>>>bits);ta=x<<32-bits}else{bits+=6;ta^=x<<32-bits}}if(bits&56){out.push(sjcl.bitArray.partial(bits&56,ta,1))}return out}};sjcl.codec.base64url={fromBits:function(arr){return sjcl.codec.base64.fromBits(arr,1,1)},toBits:function(str){return sjcl.codec.base64.toBits(str,1)}};sjcl.mode.gcm={name:"gcm",encrypt:function(prf,plaintext,iv,adata,tlen){var out,data=plaintext.slice(0),w=sjcl.bitArray;tlen=tlen||128;adata=adata||[];out=sjcl.mode.gcm._ctrMode(true,prf,data,adata,iv,tlen);return w.concat(out.data,out.tag)},decrypt:function(prf,ciphertext,iv,adata,tlen){var out,data=ciphertext.slice(0),tag,w=sjcl.bitArray,l=w.bitLength(data);tlen=tlen||128;adata=adata||[];if(tlen<=l){tag=w.bitSlice(data,l-tlen);data=w.bitSlice(data,0,l-tlen)}else{tag=data;data=[]}out=sjcl.mode.gcm._ctrMode(false,prf,data,adata,iv,tlen);if(!w.equal(out.tag,tag)){throw new sjcl.exception.corrupt("gcm: tag doesn't match")}return out.data},_galoisMultiply:function(x,y){var i,j,xi,Zi,Vi,lsb_Vi,w=sjcl.bitArray,xor=w._xor4;Zi=[0,0,0,0];Vi=y.slice(0);for(i=0;i<128;i++){xi=(x[Math.floor(i/32)]&1<<31-i%32)!==0;if(xi){Zi=xor(Zi,Vi)}lsb_Vi=(Vi[3]&1)!==0;for(j=3;j>0;j--){Vi[j]=Vi[j]>>>1|(Vi[j-1]&1)<<31}Vi[0]=Vi[0]>>>1;if(lsb_Vi){Vi[0]=Vi[0]^225<<24}}return Zi},_ghash:function(H,Y0,data){var Yi,i,l=data.length;Yi=Y0.slice(0);for(i=0;i<l;i+=4){Yi[0]^=4294967295&data[i];Yi[1]^=4294967295&data[i+1];Yi[2]^=4294967295&data[i+2];Yi[3]^=4294967295&data[i+3];Yi=sjcl.mode.gcm._galoisMultiply(Yi,H)}return Yi},_ctrMode:function(encrypt,prf,data,adata,iv,tlen){var H,J0,S0,enc,i,ctr,tag,last,l,bl,abl,ivbl,w=sjcl.bitArray;l=data.length;bl=w.bitLength(data);abl=w.bitLength(adata);ivbl=w.bitLength(iv);H=prf.encrypt([0,0,0,0]);if(ivbl===96){J0=iv.slice(0);J0=w.concat(J0,[1])}else{J0=sjcl.mode.gcm._ghash(H,[0,0,0,0],iv);J0=sjcl.mode.gcm._ghash(H,J0,[0,0,Math.floor(ivbl/4294967296),ivbl&4294967295])}S0=sjcl.mode.gcm._ghash(H,[0,0,0,0],adata);ctr=J0.slice(0);tag=S0.slice(0);if(!encrypt){tag=sjcl.mode.gcm._ghash(H,S0,data)}for(i=0;i<l;i+=4){ctr[3]++;enc=prf.encrypt(ctr);data[i]^=enc[0];data[i+1]^=enc[1];data[i+2]^=enc[2];data[i+3]^=enc[3]}data=w.clamp(data,bl);if(encrypt){tag=sjcl.mode.gcm._ghash(H,S0,data)}last=[Math.floor(abl/4294967296),abl&4294967295,Math.floor(bl/4294967296),bl&4294967295];tag=sjcl.mode.gcm._ghash(H,tag,last);enc=prf.encrypt(J0);tag[0]^=enc[0];tag[1]^=enc[1];tag[2]^=enc[2];tag[3]^=enc[3];return{tag:w.bitSlice(tag,0,tlen),data:data}}};